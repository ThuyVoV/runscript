<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>View and Upload file page</title>
</head>
<body>
    <form action="{% url 'runscript:main' %}" method="GET">
        <input type="submit" value="Back" />
    </form>

    {% if user.is_authenticated %}
        {{ script_list.owner }} owns {{ script_list.list_name }}
        <form action="{% url 'runscript:logs' script_list.id %}" method="GET">
            <input type="submit" value="Logs" />
        </form>

        <form action="{% url 'runscript:view_and_upload' script_list.id %}" method="POST">
            {% csrf_token %}

            Add user to this list
            <input type="text" name="add_user_to_list">

            <input type="submit" value="Add User" name="button_add_user"/>

        </form>

        {% if script_list.user.all %}
            <form action="{% url 'runscript:view_and_upload' script_list.id %}" method="POST">
                {% csrf_token %}

                Delete this user:

                <select name="del_user_from_list">
                    {% for user in script_list.user.all %}
                        {% if user|slugify != script_list.owner|slugify %}
                            <option value="{{ user }}">{{ user }}</option>
                        {% endif %}
                    {% endfor %}

                </select>

                <input type="submit" value="Delete User" name="button_del_user"/>
            </form>
        {% endif %}

        {% for message in messages %}
            {{ message }}
        {% endfor %}



        <!-- Upload form.  -->
        <form action="{% url 'runscript:view_and_upload' script_list.id %}" method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            <p>
                Enter script name  {{ form.script_name }}
                <br>
                {{ form.upload_file }}
            </p>
            <p><input type="submit" value="Upload" name="button_upload"/></p>
        </form>

        <!-- List of uploaded files -->
        {% if script_list.uploadfilemodel_set.all %}
            Files:
            <ul>
            {% for script in script_list.uploadfilemodel_set.all %}
                <li><a href="{% url 'runscript:detail' script.id %}">{{ script.script_name }}</a></li>
            {% endfor %}
            </ul>
        {% else %}
            <p>No files.</p>
        {% endif %}

    {% else %}
        You must login!
    {% endif %}
</body>
</html>